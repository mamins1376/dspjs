!function(){"use strict";var e,t,n,r,i,o;null!==(e=globalThis.TextDecoder)&&void 0!==e||(globalThis.TextDecoder=class{constructor(e,t){var n,r;if(this.encoding="utf-8",e&&"utf-8"!==e.toLowerCase())throw new TypeError("unsupported encoding: "+e);if(this.fatal=null===(n=null==t?void 0:t.fatal)||void 0===n||n,!this.fatal)throw new TypeError("only fatal decoding mode is supported");if(this.ignoreBOM=null===(r=null==t?void 0:t.ignoreBOM)||void 0===r||r,!this.ignoreBOM)throw new TypeError("ignoreBOM must be enabled")}decode(e,t){if(!e)return"";if(!ArrayBuffer.isView(e))throw new TypeError("passed argument must be an array buffer view");const n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=Array.from(n).map((e=>String.fromCharCode(e)));return decodeURIComponent(escape(r.join("")))}}),function(e){e.type="ready",e.make=t=>t?{type:e.type,error:t}:{type:e.type},e.check=t=>(null==t?void 0:t.type)===e.type}(t||(t={})),function(e){e.Enum={Rectangular:0,Bartlett:1,Hanning:2,Hamming:3,Blackman:4},e.Default="Hanning",e.type="windowing",e.make=t=>({type:e.type,windowing:t}),e.check=t=>(null==t?void 0:t.type)===e.type}(n||(n={})),function(e){e.optionsKeys=["fftSize","maxDecibels","minDecibels","smoothingTimeConstant","windowing"],e.type="module",e.make=(t,n)=>({type:e.type,module:t,options:n}),e.check=t=>(null==t?void 0:t.type)===e.type}(r||(r={})),function(e){e.type="time",e.make=t=>({type:e.type,buffer:t}),e.check=t=>(null==t?void 0:t.type)===e.type}(i||(i={})),function(e){e.type="frequency",e.make=t=>({type:e.type,buffer:t}),e.check=t=>(null==t?void 0:t.type)===e.type}(o||(o={}));let s,a=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});a.decode();let c=null;function l(){return null!==c&&c.buffer===s.memory.buffer||(c=new Uint8Array(s.memory.buffer)),c}let u=null,f=0;function y(e,t){const n=t(1*e.length);return l().set(e,n/1),f=e.length,n}class p{static __wrap(e){const t=Object.create(p.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_analyzer_free(e)}constructor(e,t,n,r,i){var o=s.analyzer_new(e,t,n,r,i);return p.__wrap(o)}change_windowing(e){s.analyzer_change_windowing(this.ptr,e)}feed(e){var t=function(e,t){const n=t(4*e.length);return(null!==u&&u.buffer===s.memory.buffer||(u=new Float32Array(s.memory.buffer)),u).set(e,n/4),f=e.length,n}(e,s.__wbindgen_malloc);return 0!==s.analyzer_feed(this.ptr,t,f)}time(e){try{var t=y(e,s.__wbindgen_malloc),n=f;s.analyzer_time(this.ptr,t,n)}finally{e.set(l().subarray(t/1,t/1+n)),s.__wbindgen_free(t,1*n)}}frequency(e){try{var t=y(e,s.__wbindgen_malloc),n=f;s.analyzer_frequency(this.ptr,t,n)}finally{e.set(l().subarray(t/1,t/1+n)),s.__wbindgen_free(t,1*n)}}}async function h(e){void 0===e&&(e=new URL("index_bg.wasm",document.currentScript&&document.currentScript.src||new URL("index.js",document.baseURI).href));const t={wbg:{}};t.wbg.__wbindgen_throw=function(e,t){throw Error((n=e,r=t,a.decode(l().subarray(n,n+r))));var n,r},("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return s=n.exports,h.__wbindgen_wasm_module=r,s}class d extends AudioWorkletProcessor{constructor(){super(),this.port.addEventListener("message",this.message.bind(this)),this.port.start()}message({data:e}){if(!(e=>[t.check,r.check,i.check,o.check,n.check].some((t=>t(e))))(e))throw new TypeError("Invalid message data on worklet thread: "+e);if(r.check(e)){const n=e=>this.port.postMessage(t.make(e));h(e.module).then((()=>n())).catch((e=>n(e))),this.options=e.options}n.check(e)&&this.analyzer&&this.analyzer.change_windowing(n.Enum[e.windowing])}process([e]){var t;if(this.options&&e.length&&(null!==(t=this.analyzer)&&void 0!==t||(this.analyzer=new p(this.options.fftSize,this.options.maxDecibels,this.options.minDecibels,this.options.smoothingTimeConstant,n.Enum[this.options.windowing])),this.analyzer.feed(e[0]))){let e=new Uint8Array(this.options.fftSize);this.analyzer.time(e),this.port.postMessage(i.make(e),[e.buffer]),e=new Uint8Array(this.options.fftSize>>1),this.analyzer.frequency(e),this.port.postMessage(o.make(e),[e.buffer])}return!0}}registerProcessor("custom-worklet",d)}();
